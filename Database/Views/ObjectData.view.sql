-- Check if View exists and deletes it if yes
IF EXISTS (SELECT name
	FROM sysobjects
	WHERE name = 'ObjectData'
	AND type = 'V')
DROP VIEW ObjectData
GO

-- View
CREATE VIEW ObjectData

AS

SELECT
TAG_OBJECT.ObjectId,
TAG_OBJECT.SfiNumber,
TAG_OBJECT.MainEqNumber,
TAG_OBJECT.EqNumber,
TAG_OBJECT.ObjectDescription,
HIERARCHY_1.Hierarchy1Name,
HIERARCHY_2.Hierarchy2Name,
VDU_GROUP.VduGroupName,
ALARM_GROUP.AlarmGroupName,
OTD.OtdName,
ACKNOWLEDGE_ALLOWED.AcknowledgeAllowedLocation,
ALWAYS_VISIBLE.AlwaysVisibleLocation,
NODE.NodeName,
CABINET.CabinetName,
DATA_BLOCK.DataBlockName

FROM TAG_OBJECT
INNER JOIN HIERARCHY_1 ON TAG_OBJECT.Hierarchy1Id = HIERARCHY_1.Hierarchy1Id
INNER JOIN HIERARCHY_2 ON TAG_OBJECT.Hierarchy2Id = HIERARCHY_2.Hierarchy2Id
INNER JOIN VDU_GROUP ON TAG_OBJECT.VduGroupId = VDU_GROUP.VduGroupId
INNER JOIN ALARM_GROUP ON TAG_OBJECT.AlarmGroupId = ALARM_GROUP.AlarmGroupId
INNER JOIN OTD ON TAG_OBJECT.OtdId = OTD.OtdId
INNER JOIN ACKNOWLEDGE_ALLOWED 
ON TAG_OBJECT.AcknowledgeAllowedId = ACKNOWLEDGE_ALLOWED.AcknowledgeAllowedId
INNER JOIN ALWAYS_VISIBLE 
ON TAG_OBJECT.AlwaysVisibleId = ALWAYS_VISIBLE.AlwaysVisibleId
INNER JOIN NODE ON TAG_OBJECT.NodeId = NODE.NodeId
INNER JOIN CABINET ON TAG_OBJECT.CabinetId = CABINET.CabinetId
INNER JOIN DATA_BLOCK ON TAG_OBJECT.DataBlockId = DATA_BLOCK.DataBlockId

GO